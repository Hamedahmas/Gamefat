<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <title>ÙˆØ±ÙˆØ¯ Ø¨Ø§Ø²ÛŒÚ©Ù†</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="centered">
    <h2>ğŸ™‹â€â™‚ï¸ ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø¨Ø§Ø²ÛŒ</h2>
    <input id="name" placeholder="Ù†Ø§Ù… Ø¨Ø§Ø²ÛŒÚ©Ù†" />
    <button onclick="joinGame()">ÙˆØ±ÙˆØ¯</button>
  </div>
  <script>
    const params = new URLSearchParams(location.search);
    const code = params.get("game");

    function joinGame() {
      const name = document.getElementById('name').value;
      if (!name) return alert("Ù†Ø§Ù… Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯");
      const gameData = JSON.parse(localStorage.getItem('game_' + code));
      if (!gameData) return alert("Ú©Ø¯ Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª");
      let players = JSON.parse(localStorage.getItem('players_' + code) || "[]");
      if (players.find(p => p.name === name)) return alert("Ø§ÛŒÙ† Ù†Ø§Ù… Ù‚Ø¨Ù„Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡");
      if (players.length >= gameData.count) return alert("Ø¨Ø§Ø²ÛŒ Ù¾Ø± Ø´Ø¯Ù‡");
      players.push({ name });
      localStorage.setItem('players_' + code, JSON.stringify(players));
      localStorage.setItem('myName', name);
      location.href = 'game.html?game=' + code;
    }
  </script>
</body>
</html>